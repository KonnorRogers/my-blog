<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><style data-href="/styles.66d4e3963248b5e32de0.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}*,:after,:before{box-sizing:border-box}html{font-family:"sans-serif";font-size:17px}code{display:inline-block;font-size:85%;color:#9efeff;background:#2d2a55;padding:0 .4rem;margin:.2rem .1rem;border-radius:3px}.prism-code{margin-top:-2rem;margin-bottom:3rem;overflow-x:auto;padding:2rem 1.5rem 1.5rem;position:relative;display:block}.token-line{overflow-wrap:unset;word-break:keep-all}.token-line:after{content:"";width:2rem;position:absolute;right:-2rem;height:0}.token:last-child{padding-right:2rem}.prism-code>.token-line:first-of-type{margin-top:1.5rem}.prism-code+.reference-file{margin-top:-2rem;margin-bottom:2rem}.gatsby-code-meta{align-items:center;display:flex;position:relative;padding:0;margin:0;right:0;top:0;border-bottom:1px solid;width:100%;z-index:100}.gatsby-code-meta-text{display:block;font-size:.75rem;line-height:1.95rem;margin:0 -1px 0 auto;height:100%;border-color:inherit;padding:0 1px}.gatsby-code-meta-copy{font-family:inherit;font-size:100%;display:block;background-color:inherit;cursor:pointer;width:100%;padding:0;min-width:5rem;color:inherit;border:none;border-left:1px solid;border-color:inherit}.gatsby-code-meta-copy[disabled]:focus,.gatsby-code-meta-copy[disabled]:hover{outline:none}.gatsby-code-meta-copy[disabled]{cursor:unset}.gatsby-code-meta-copy:not([disabled]):focus,.gatsby-code-meta-copy:not([disabled]):hover{color:var(--code-hover-color);background-color:var(--code-hover-bg);padding:-1px}</style><meta name="generator" content="Gatsby 2.22.11"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-149870384-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-149870384-1', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="alternate" type="application/rss+xml" title="Gatsby RSS feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=edf3d310d67f8284a562bc3a58c3e761"/><title data-react-helmet="true">Getting Started with Rails 6 | Konnor&#x27;s Blog</title><meta data-react-helmet="true" name="description" content="Purpose The purpose of this is to have a reusable source for setting up a Rails
6 project. I will be using the  Getting Started with Rails
Guide  to setup a
new…"/><meta data-react-helmet="true" property="og:title" content="Getting Started with Rails 6"/><meta data-react-helmet="true" property="og:description" content="Purpose The purpose of this is to have a reusable source for setting up a Rails
6 project. I will be using the  Getting Started with Rails
Guide  to setup a
new…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Konnor Rogers"/><meta data-react-helmet="true" name="twitter:title" content="Getting Started with Rails 6"/><meta data-react-helmet="true" name="twitter:description" content="Purpose The purpose of this is to have a reusable source for setting up a Rails
6 project. I will be using the  Getting Started with Rails
Guide  to setup a
new…"/><link as="script" rel="preload" href="/webpack-runtime-d400cf8828ee40283933.js"/><link as="script" rel="preload" href="/framework-75da9754c2a76bbaf08a.js"/><link as="script" rel="preload" href="/styles-0088909554f7ad2ac065.js"/><link as="script" rel="preload" href="/f0e45107-357d362de354e57f12c0.js"/><link as="script" rel="preload" href="/app-dfd7e3cc412d2a4138ba.js"/><link as="script" rel="preload" href="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-ef5a3f720f86f4181618.js"/><link as="script" rel="preload" href="/cd7d5f864fc9e15ed8adef086269b0aeff617554-caa56a3535a2d7b69d6c.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-a1eb9d2be463054631c2.js"/><link as="fetch" rel="preload" href="/page-data/rails/getting-started-with-rails-6/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><h3 style="font-family:Montserrat, sans-serif;margin-top:0;margin-bottom:-1.75rem"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">Konnor&#x27;s Blog</a></h3><h1>Getting Started with Rails 6</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.75rem">May 03, 2020</p><h2>Purpose</h2><p>The purpose of this is to have a reusable source for setting up a Rails
6 project.</p><p>I will be using the <a href="https://guides.rubyonrails.org/getting_started.html">Getting Started with Rails
Guide</a> to setup a
new Rails projects.</p><p>Initially I used <a href="https://docs.docker.com/compose/rails/">Docker Quickstart with Compose and Rails
guide</a> but quickly realized I
had other needs for Rails 6. My docker setup is the result of multiple
resources.</p><p>I will also be using Docker just to provide a consistent development
environment. Docker is not required, I used it simply to be able to
provide a reproducible environment.</p><p>Source code can be found here:</p><p><a href="https://github.com/ParamagicDev/getting-started-with-rails-6">https://github.com/ParamagicDev/getting-started-with-rails-6</a></p><p>Deployed application can be found here:</p><p><a href="https://getting-started-with-rails-6.herokuapp.com/">https://getting-started-with-rails-6.herokuapp.com/</a></p><h2 id="table-of-contents"><a href="#table-of-contents">Table Of Contents</a></h2><ul><li><p><a href="#prerequisites">Prerequisites</a></p></li><li><p><a href="#technologies">Main Technologies</a></p></li><li><p><a href="#getting-started">Getting Started</a></p><ul><li><a href="#adding-a-dockerfile">Adding a Dockerfile</a></li><li><a href="#adding-a-gemfile">Adding a Gemfile</a></li><li><a href="#adding-a-package.json">Adding a package.json</a></li><li><a href="#adding-entrypoint-sh">Adding entrypoint.sh</a></li><li><a href="#adding-docker-compose-yml">Adding docker-compose.yml</a></li><li><a href="#adding-a-dot-docker-ignore-file">Adding a .dockerignore file</a></li><li><a href="#prebuild-directory-structure">Prebuild Directory Structure</a></li><li><a href="#prebuild-reference-repository">Prebuild Reference Repository</a></li><li><a href="#postbuild-directory-structure">Postbuild Directory Structure</a></li><li><a href="#postbuild-reference-repository">Postbuild Reference Repository</a></li></ul></li><li><p><a href="#building-the-project">Building the Project</a></p><ul><li><a href="#create-the-rails-app">Create the Rails app</a><ul><li><a href="#ownership-issues">Ownership Issues</a></li></ul></li><li><a href="#building-the-docker-container">Building the Docker Container</a></li><li><a href="#connecting-the-database">Connecting the Database</a></li></ul></li><li><p><a href="#using-docker">Using Docker</a></p><ul><li><a href="#stopping-the-application">Stopping the Application</a></li><li><a href="#starting-the-application">Starting the Application</a></li><li><a href="#extra-tips">Extra Tips</a></li><li><a href="#useful-commands">Useful Commands</a></li></ul></li><li><p><a href="#adding-additional-functionality">Adding additional functionality</a></p></li><li><p><a href="#deployment">Deployment</a></p></li><li><p><a href="#issues">Issues</a></p></li><li><p><a href="#i-know-what-im-doing">I know what I’m doing</a></p></li><li><p><a href="#links">Links</a></p><ul><li><a href="#source-code">Github Source Code</a></li><li><a href="#deployed-app">Deployed app on Heroku</a></li><li><a href="#submit-a-pull-request">Found something wrong?</a></li></ul></li></ul><h2 id="prerequisites"><a href="#prerequisites">Prerequisites</a></h2><ul><li><a href="https://docs.docker.com/get-docker/">Docker</a></li><li><a href="https://docs.docker.com/compose/install/">Docker Compose</a></li></ul><p>Make sure to install both Docker and Docker Compose prior to starting
this tutorial.</p><p>To verify run the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker -v</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Docker version 19.03.8</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose -v</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># docker-compose version 1.25.0</span></div></pre><h2 id="technologies"><a href="#technologies">Main Technologies</a></h2><ul><li>Ruby 2.5.8</li><li>Rails 6.0.2</li><li>PostgresQL 11.6</li></ul><h2 id="getting-started"><a href="#getting-started">Getting Started</a></h2><p>If you don’t want any explanations, skip to the <a href="#i-know-what-im-doing">I know what I’m doing</a>
section of this post.</p><p>Alright first lets create our directory where we want the Rails app. I
named mine <code>getting-started-with-rails-6</code></p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token function" style="color:rgb(250, 208, 0)">mkdir</span><span class="token plain"> getting-started-with-rails-6</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token function" style="color:rgb(250, 208, 0)">cd</span><span class="token plain"> getting-started-with-rails-6</span></div></pre><h3 id="adding-a-dockerfile"><a href="#adding-a-dockerfile">Adding a Dockerfile</a></h3><p>The next step is to create our <code>Dockerfile</code>.
The below <code>Dockerfile</code> is modified from the <a href="https://docs.docker.com/compose/rails/">Docker Quickstart
Rails</a></p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-yaml" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Dockerfile</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Pre setup stuff</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">FROM ruby</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">2.5.8 as builder</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Add Yarn to the repository</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN curl https</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">//deb.nodesource.com/setup_12.x </span><span class="token punctuation" style="color:rgb(255, 255, 255)">|</span><span class="token plain"> bash     &amp;&amp; curl https</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">//dl.yarnpkg.com/debian/pubkey.gpg </span><span class="token punctuation" style="color:rgb(255, 255, 255)">|</span><span class="token plain"> apt</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">key add </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">     &amp;&amp; echo &quot;deb https</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">//dl.yarnpkg.com/debian/ stable main&quot; </span><span class="token punctuation" style="color:rgb(255, 255, 255)">|</span><span class="token plain"> tee /etc/apt/sources.list.d/yarn.list</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Install system dependencies &amp; clean them up</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN apt</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">get update </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">qq &amp;&amp; apt</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">get install </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">y \</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    postgresql</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">client build</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">essential yarn nodejs \</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    libnotify</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">dev &amp;&amp; \</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    rm </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">rf /var/lib/apt/lists/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># This is where we build the rails app</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">FROM builder as rails</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">app</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Allow access to port 3000</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">EXPOSE 3000</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">EXPOSE 3035</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># This is to fix an issue on Linux with permissions issues</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">ARG USER_ID=1000</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">ARG GROUP_ID=1000</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">ARG APP_DIR=/home/user/myapp</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Create a non-root user</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN groupadd </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">gid $GROUP_ID user</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN useradd </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">no</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">log</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">init </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">uid $USER_ID </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">gid $GROUP_ID user </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">create</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">home</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Remove existing running server</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY entrypoint.sh /usr/bin/</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN chmod +x /usr/bin/entrypoint.sh</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Permissions crap</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN mkdir </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">p $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN chown </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">R $USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Define the user running the container</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">USER $USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">WORKDIR $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Install rails related dependencies</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">chown=$USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID Gemfile* $APP_DIR/</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># For webpacker / node_modules</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">chown=$USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID package.json $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">chown=$USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID yarn.lock $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN bundle install</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Copy over all files</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">chown=$USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID . .</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN yarn install </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">check</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">files</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">ENTRYPOINT </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;/usr/bin/entrypoint.sh&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Start the main process.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">CMD </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;rails&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;server&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;-b&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;0.0.0.0&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span></div></pre><p><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/blob/prior-to-rails-new/Dockerfile">Reference File on
Github</a></p><h3 id="adding-a-gemfile"><a href="#adding-a-gemfile">Adding a Gemfile</a></h3><p>Next we will deviate slightly from the above Docker quickstart. Instead
of using Rails 5 we’ll use Rails 6.</p><p>Create a <code>Gemfile</code> with the following contents:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-ruby" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain"># Gemfile</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">source &#x27;https://rubygems.org&#x27;</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">gem &#x27;rails&#x27;, &#x27;~&gt; 6&#x27;</span></div></pre><p><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/blob/prior-to-rails-new/Gemfile">Reference File on Github</a></p><p>Then add an empty <code>Gemfile.lock</code></p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token function" style="color:rgb(250, 208, 0)">touch</span><span class="token plain"> Gemfile.lock</span></div></pre><h3 id="adding-a-package-json"><a href="#adding-a-package-json">Adding a package.json</a></h3><p>There are a few options to generate your <code>package.json</code> so lets keep it
simple, create a file with the following settings:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-json" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token property" style="color:rgb(255, 157, 0)">&quot;_filename&quot;</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;package.json&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token property" style="color:rgb(255, 157, 0)">&quot;name&quot;</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;myapp&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token property" style="color:rgb(255, 157, 0)">&quot;private&quot;</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 98, 140)">true</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token property" style="color:rgb(255, 157, 0)">&quot;version&quot;</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;0.1.0&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span></div></pre><p><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/blob/prior-to-rails-new/package.json">Reference File on
Github</a></p><p>Also, add an empty <code>yarn.lock</code> because Rails uses yarn by default.</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token function" style="color:rgb(250, 208, 0)">touch</span><span class="token plain"> yarn.lock</span></div></pre><h3 id="adding-entrypoint-sh"><a href="#adding-entrypoint-sh">Adding entrypoint.sh</a></h3><p>Now lets create an <code>entrypoint.sh</code> script to fix a server issue with
Rails.</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># entrypoint.sh</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">set</span><span class="token plain"> -e</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Remove a potentially pre-existing server.pid for Rails.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token function" style="color:rgb(250, 208, 0)">rm</span><span class="token plain"> -f /myapp/tmp/pids/server.pid</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Then exec the container&#x27;s main process (what&#x27;s set as CMD in the Dockerfile).</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token function" style="color:rgb(250, 208, 0)">exec</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token string variable" style="color:rgb(255, 238, 128)">$@</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span></div></pre><p><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/blob/prior-to-rails-new/entrypoint.sh">Reference File on
Github</a></p><h3 id="adding-docker-compose-yml"><a href="#adding-docker-compose-yml">Adding docker-compose.yml</a></h3><p>Finally, lets add a <code>docker-compose.yml</code> with the following content:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-yaml" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># docker-compose.yml</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;3&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">web</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">NODE_ENV</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> development</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">RAILS_ENV</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> development</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">WEBPACKER_DEV_SERVER_HOST</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> 0.0.0.0</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">POSTGRES_USER</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> postgres</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> example</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">context</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> .</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">args</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">        </span><span class="token key atrule">USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(255, 98, 140)">1000</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">        </span><span class="token key atrule">GROUP_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(255, 98, 140)">1000</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">        </span><span class="token key atrule">APP_DIR</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> /home/user/myapp</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> bash </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">c &quot;rm </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">f tmp/pids/server.pid &amp;&amp;</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      ./bin/webpack</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">dev</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">server &amp;</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      bundle exec rails server </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">p 3000 </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">b &#x27;0.0.0.0&#x27;&quot;</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># make sure this lines up with APP_DIR above</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> .</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">/home/user/myapp</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;3000:3000&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;3035:3035&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> db</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">db</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> postgres</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token number" style="color:rgb(255, 98, 140)">12.2</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> example</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> db_data</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">/var/lib/postgresql/data</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  db_data</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span></div></pre><p><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/blob/prior-to-rails-new/docker-compose.yml">Reference File on
Github</a></p><h3 id="adding-a-dot-docker-ignore-file"><a href="#adding-a-dot-docker-ignore-file">Adding a .dockerignore file</a></h3><p>Finally, its good practice to add a <code>.dockerignore</code> file. The
<code>.dockerignore</code> is very similar to <code>.gitignore</code> and this one will very
closely resemble your <code>.gitignore</code> that Rails will generate.</p><p>Create a <code>.dockerignore</code> file with the following contents:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># .dockerignore</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore bundler config.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/.bundle</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore all logfiles and tempfiles.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/log/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/tmp/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/log/.keep</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/tmp/.keep</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore pidfiles, but keep the directory.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/tmp/pids/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/tmp/pids/</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/tmp/pids/.keep</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore uploaded files in development.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/storage/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/storage/.keep</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/public/assets</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">.byebug_history</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore master key for decrypting credentials and more.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/config/master.key</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/public/packs</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/public/packs-test</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/node_modules</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/yarn-error.log</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">yarn-debug.log*</span></div></pre><p><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/blob/prior-to-rails-new/.dockerignore">Reference File on
Github</a></p><h3 id="prebuild-directory-structure"><a href="#prebuild-directory-structure">Prebuild Directory Structure</a></h3><p>Your directory should look as follows:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token keyword" style="color:rgb(255, 157, 0)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── docker-compose.yml</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── .dockerignore</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── Dockerfile</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── entrypoint.sh</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── Gemfile</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── Gemfile.lock</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── package.json</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">└── yarn.lock</span></div></pre><p>For reference, I have created a Github branch to represent the file
structure.</p><h3 style="margin-top:0" id="prebuild-reference-repository"><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/tree/prior-to-rails-new">Prebuild Reference Repository Branch</a></h3><br/><h2 id="building-the-project"><a href="#building-the-project">Building the Project</a></h2><h3 id="create-the-rails-app"><a href="create-the-rails-app">Create the Rails app</a></h3><p>Prior to building the docker container, you have to create the Rails app
structure. To do so, run the command below inside of your Rails project
directory.</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm --no-deps web rails new </span><span class="token keyword" style="color:rgb(255, 157, 0)">.</span><span class="token plain"> --force --no-deps --database</span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain">postgresql</span></div></pre><p>This will build a fresh Rails project for you using <code>PostgresQL</code> as the
database adapter.</p><h3 id="postbuild-directory-structure"><a href="#postbuild-directory-structure">Postbuild Directory Structure</a></h3><p>Your Rails directory should look as follows:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token keyword" style="color:rgb(255, 157, 0)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── app</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── babel.config.js</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── bin</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── .browserslistrc</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── config</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── config.ru</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── docker-compose.yml</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── .dockerignore</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── Dockerfile</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── entrypoint.sh</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── Gemfile</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── Gemfile.lock</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── .git</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── .gitignore</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── lib</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── log</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── package.json</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── postcss.config.js</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── public</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── Rakefile</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── README.md</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── .ruby-version</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── storage</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── </span><span class="token function" style="color:rgb(250, 208, 0)">test</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── tmp</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">├── vendor</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">└── yarn.lock</span></div></pre><h3 style="margin-top:0" id="postbuild-reference-repository"><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/tree/before-making-blog">Directory Structure after Rails new</a></h3><h4 id="ownership-issues"><a href="#ownership-issues">Ownership Issues</a></h4><p>You may run into ownership issues on Linux. I did my best to fix this.
In case anything still lingers, run the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token function" style="color:rgb(250, 208, 0)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">chown</span><span class="token plain"> -R </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token string variable" style="color:rgb(255, 238, 128)">$USER</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token keyword" style="color:rgb(255, 157, 0)">:</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token string variable" style="color:rgb(255, 238, 128)">$USER</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">.</span></div></pre><p>And if you’re feeling real crazy, you can setup an <code>alias</code> for this
command. I have mine called <code>ownthis</code></p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token function" style="color:rgb(250, 208, 0)">alias</span><span class="token plain"> ownthis</span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;sudo chown -R </span><span class="token string variable" style="color:rgb(255, 238, 128)">$USER</span><span class="token string" style="color:rgb(165, 255, 144)">:</span><span class="token string variable" style="color:rgb(255, 238, 128)">$USER</span><span class="token string" style="color:rgb(165, 255, 144)"> .&quot;</span></div></pre><h3 id="connecting-the-database"><a href="#connecting-the-database">Connecting the Database</a></h3><p>In order to connect the Database to Rails, you have to tell Rails where
to find the database. To do so, navigate to your <code>config/database.yml</code>
file.</p><p>Delete the contents of your <code>config/database.yml</code> and add the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-yaml" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># config/database.yml</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token important">&amp;default</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">adapter</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> postgresql</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">encoding</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> unicode</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> db</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> &lt;%= ENV</span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">&#x27;POSTGRES_USER&#x27;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"> %</span><span class="token punctuation" style="color:rgb(255, 255, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> &lt;%= ENV</span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">&#x27;POSTGRES_PASSWORD&#x27;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"> %</span><span class="token punctuation" style="color:rgb(255, 255, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">pool</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(255, 98, 140)">5</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">development</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">&lt;&lt;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token important">*default</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> myapp_development</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">test</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">&lt;&lt;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token important">*default</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> myapp_test</span></div></pre><p>Now you can boot the app using the following command:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose up --build</span></div></pre><p>In another terminal, run the following commands:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm web rails db:create</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm web rails db:migrate</span></div></pre><p>Congratulations! You have finished the setup portion of the application!</p><p>Now you should be able to view your app by navigating to:</p><p><code>localhost:3000</code> in your browser’s address bar.</p><p>You should see a message congratulating you for using Rails.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:590px">
      <a class="gatsby-resp-image-link" href="/static/11b13ba3a6b3c3f05bd4086d8b8e24aa/e67a8/youre-on-rails.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:56.75675675675676%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfUlEQVQoz32Sy07DMBBF89ss+AI+gRVigVghFbFg2cCCSqWozaMQWlQqaPNoWkKf2LEvY6cJoSmMdBR77vjGo7FRq9XgeR46nQ4sy4Jt21UcZ39e48Ah3erY+mt0u12oWC4XWK7W4Kkg0i0CjNgwDi4lGKdcDuW/KJ8KqmEMnEntY7Tbbb3gnEGQmJJRAecQpM2pZum6tJa/9RJCCn3eUK2qUJvdkFQUTWJEIx/+8A1jP9CH9wU1QMjfhiqRQ7IuEnxNyymkiCBYQrl0ayAr6JZ3byizXyHTP8EWz4gHLUyGLawSF5K9Z3p+rZ2otlyYSayiHryHFhr1M1jNGzw1LExfXdJY0eK/hj/X12OC/XiBq/tD9KI67l6Ocdk8gNM/1VpuuGtaTFlPSoiSsUBrdILbwRGSeYx+aMIOz9GLr3UXQrGtL2O4rrt3auuVGgbdnGYwm32Ab1QbGZye019hmKaJJEkQBAHCMCzwfXoqwVjnoyhCEKr9iPLjSm2Zb7UrR3u0sDhFAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="You&#x27;re on Rails 6" title="You&#x27;re on Rails 6" src="/static/11b13ba3a6b3c3f05bd4086d8b8e24aa/fcda8/youre-on-rails.png" srcSet="/static/11b13ba3a6b3c3f05bd4086d8b8e24aa/12f09/youre-on-rails.png 148w,/static/11b13ba3a6b3c3f05bd4086d8b8e24aa/e4a3f/youre-on-rails.png 295w,/static/11b13ba3a6b3c3f05bd4086d8b8e24aa/fcda8/youre-on-rails.png 590w,/static/11b13ba3a6b3c3f05bd4086d8b8e24aa/efc66/youre-on-rails.png 885w,/static/11b13ba3a6b3c3f05bd4086d8b8e24aa/c83ae/youre-on-rails.png 1180w,/static/11b13ba3a6b3c3f05bd4086d8b8e24aa/e67a8/youre-on-rails.png 1740w" sizes="(max-width: 590px) 100vw, 590px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><h3 style="margin-top:0" id="prior-to-adding-functionality-branch"><a href="https://github.com/ParamagicDev/getting-started-with-rails-6/tree/prior-to-adding-stuff">Github Branch Prior to adding additional functionality</a></h3><h2 id="using-docker"><a href="#using-docker">Using Docker</a></h2><h3 id="stopping-the-application"><a href="#stopping-the-application">Stopping the application</a></h3><p>To stop the application, in another terminal simply run:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose down</span></div></pre><h3 id="starting-the-application"><a href="#starting-the-application">Starting the application</a></h3><p>To start the application there are two methods.</p><p>If you have added anything to the <code>Gemfile</code>, in order to sync the
changes, you must run the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run web bundle </span><span class="token function" style="color:rgb(250, 208, 0)">install</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose up --build</span></div></pre><p>If you have not changed anything <code>Gemfile</code> related but you may have
changed the <code>docker-compose.yml</code> file, you can simply run:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose up --build</span></div></pre><p>However, if you do not need to rebuild, you can simply run:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose up</span></div></pre><h2 id="extra-tips"><a href="#extra-tips">Extra Tips</a></h2><p>As a simple way to get you going, anytime you see</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">rails </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span></div></pre><p>simply prepend the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm web rails </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span></div></pre><p><code>docker-compose exec</code> is to be run if you have a container already
running.</p><p><code>docker-compose run</code> is to be run if you do not have a container
running.</p><p><code>docker-compose run --rm</code> will automatically remove the docker instance
once the command finished</p><h2 id="useful-commands"><a href="#useful-commands">Useful Commands</a></h2><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># builds a container</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose build</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># starts a container thats been built (equivalent to `rails server`)</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose up</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># starts and builds a container</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose up --build</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># runs a one-off instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm web </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># runs a command inside of a running container</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># `docker-compose up` needs to be running in another terminal</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose </span><span class="token function" style="color:rgb(250, 208, 0)">exec</span><span class="token plain"> web </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># stops the application</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose down</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Remove orphaned containers as well</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose down --remove-orphans</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># run a bash instance inside of the docker-compose container</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># now you can simply run commands like `rails db:migrate` without</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># adding `docker-compose run web` before every command</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm web /bin/bash</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Things are totally jacked up? Remove all images and containers.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># https://stackoverflow.com/a/52179797</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker </span><span class="token function" style="color:rgb(250, 208, 0)">rm</span><span class="token plain"> </span><span class="token variable" style="color:rgb(255, 238, 128)">$(</span><span class="token variable" style="color:rgb(255, 238, 128)">docker </span><span class="token variable function" style="color:rgb(250, 208, 0)">ps</span><span class="token variable" style="color:rgb(255, 238, 128)"> -q -a</span><span class="token variable" style="color:rgb(255, 238, 128)">)</span><span class="token plain"> -f </span><span class="token operator" style="color:rgb(255, 157, 0)">&amp;&amp;</span><span class="token plain"> docker rmi </span><span class="token variable" style="color:rgb(255, 238, 128)">$(</span><span class="token variable" style="color:rgb(255, 238, 128)">docker images -q</span><span class="token variable" style="color:rgb(255, 238, 128)">)</span><span class="token plain"> -f</span></div></pre><h2 id="adding-additional-functionality"><a href="#adding-additional-functionality">Adding additional functionality</a></h2><p>In an effort to keep this blog post semi-short in length, I will refer
you to the Rails guide for this part as nothing will be different. Once
you’re finished going through the Rails guide, come back here and we
will deploy to Heroku!</p><p><a href="https://guides.rubyonrails.org/getting_started.html#say-hello-rails">Ruby on Rails Guide to Getting
Started</a></p><p>You can skip to section 4.2 because everything prior to that we have
just done above.</p><h2 id="deployment"><a href="#deployment">Deployment to Heroku</a></h2><p>First, lets create a Heroku account. To do so, head on over to their
signup page.</p><p><a href="https://signup.heroku.com/">https://signup.heroku.com/</a></p><p>After creating an account, install the Heroku CLI.</p><p><a href="https://devcenter.heroku.com/articles/heroku-cli#download-and-install">Installation instructions can be found
here.</a></p><p>Now that you have Heroku CLI installed you can login via terminal.</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">heroku login</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># heroku: Enter your Heroku credentials</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Email: schneems@example.com</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Password:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Could not find an existing public key.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Would you like to generate one? [Yn]</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Generating new SSH public key.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Uploading ssh public key /Users/adam/.ssh/id_rsa.pub</span></div></pre><p>After you have logged in, you can now create a Heroku <code>dyno</code>. Basically
what this means is they will provision a server for you to host your
site. To do this, simply run the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">heroku apps:create </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token plain">Your-app-name</span><span class="token operator" style="color:rgb(255, 157, 0)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Creating ⬢ &lt;Your-app-name&gt;... done</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># https://&lt;Your-app-name&gt;.herokuapp.com/ |</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">https://git.heroku.com/</span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token plain">Your-app-name</span><span class="token operator" style="color:rgb(255, 157, 0)">&gt;</span><span class="token plain">.git</span></div></pre><p>Now deployment is as simple as:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token function" style="color:rgb(250, 208, 0)">git</span><span class="token plain"> push heroku master</span></div></pre><p>After waiting a little bit you should see something like the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">remote: -----</span><span class="token operator" style="color:rgb(255, 157, 0)">&gt;</span><span class="token plain"> Launching</span><span class="token punctuation" style="color:rgb(255, 255, 255)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">remote:        Released v6</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">remote:        https://</span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token plain">Your-app-name</span><span class="token operator" style="color:rgb(255, 157, 0)">&gt;</span><span class="token plain">.herokuapp.com/ deployed to Heroku</span></div></pre><p>To visit your site, simply run:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">heroku </span><span class="token function" style="color:rgb(250, 208, 0)">open</span></div></pre><p>However, youre not done yet! If you got to your site and go visit the
<code>/articles</code> section, you will run into an error. This is because you
have not migrated the database on Heroku. To do so, run the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">heroku run rails db:migrate</span></div></pre><p>Now you’re done! Good luck with everything and I hope this was helpful!</p><p><a href="#links">Helpful Links below</a></p><h2 id="issues"><a href="#issues">Issues</a></h2><p>Problems with ownership?</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token function" style="color:rgb(250, 208, 0)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">chown</span><span class="token plain"> -R </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token string variable" style="color:rgb(255, 238, 128)">$USER</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token keyword" style="color:rgb(255, 157, 0)">:</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token string variable" style="color:rgb(255, 238, 128)">$USER</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">.</span></div></pre><p>Things not working as expected?</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose down --remove-orphans</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose up --build</span></div></pre><p>Tired of the <code>yarn install --check-files</code> issues?
Disable it!</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-yaml" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># config/webpacker.yml</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># ...</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">check_yarn_integrity</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 98, 140)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># ...</span></div></pre><p>Alternatively, run the following to fix this issue:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm web </span><span class="token function" style="color:rgb(250, 208, 0)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">install</span><span class="token plain"> --check-files</span></div></pre><p>No space left on device??</p><p><a href="https://success.docker.com/article/error-message-no-space-left-on-device-in-default-machine">https://success.docker.com/article/error-message-no-space-left-on-device-in-default-machine</a></p><br/><p>Postgres not updating a new name / passsword? You must first delete its
volume to tell postgres to rebuild it.</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker volume </span><span class="token function" style="color:rgb(250, 208, 0)">ls</span><span class="token plain"> </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># lists the volumes</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker volume </span><span class="token function" style="color:rgb(250, 208, 0)">rm</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token plain">volume-name</span><span class="token operator" style="color:rgb(255, 157, 0)">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># removes the volume</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker volume prune </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token plain">--force</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"> </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># remove all unused volumes</span></div></pre><h2 id="i-know-what-im-doing"><a href="#i-know-what-im-doing">I know what I&#x27;m doing.</a></h2><p>This section is meant to be the TLDR version of the above.
This will move quickly and is meant more as a reference.
To skip this section, click on the below link:</p><p><a href="#links">Links sections</a></p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token function" style="color:rgb(250, 208, 0)">mkdir</span><span class="token plain"> -p new-rails-app</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token function" style="color:rgb(250, 208, 0)">cd</span><span class="token plain"> new-rails-app</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token function" style="color:rgb(250, 208, 0)">touch</span><span class="token plain"> Dockerfile docker-compose.yml entrypoint.sh \</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      Gemfile Gemfile.lock yarn.lock package.json \</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      .dockerignore</span></div></pre><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-yaml" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Dockerfile</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Pre setup stuff</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">FROM ruby</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">2.5.8 as builder</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Add Yarn to the repository</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN curl https</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">//deb.nodesource.com/setup_12.x </span><span class="token punctuation" style="color:rgb(255, 255, 255)">|</span><span class="token plain"> bash     &amp;&amp; curl https</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">//dl.yarnpkg.com/debian/pubkey.gpg </span><span class="token punctuation" style="color:rgb(255, 255, 255)">|</span><span class="token plain"> apt</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">key add </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">     &amp;&amp; echo &quot;deb https</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">//dl.yarnpkg.com/debian/ stable main&quot; </span><span class="token punctuation" style="color:rgb(255, 255, 255)">|</span><span class="token plain"> tee /etc/apt/sources.list.d/yarn.list</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Install system dependencies &amp; clean them up</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN apt</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">get update </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">qq &amp;&amp; apt</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">get install </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">y \</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    postgresql</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">client build</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">essential yarn nodejs \</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    libnotify</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">dev &amp;&amp; \</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    rm </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">rf /var/lib/apt/lists/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># This is where we build the rails app</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">FROM builder as rails</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">app</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Allow access to port 3000</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">EXPOSE 3000</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">EXPOSE 3035</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># This is to fix an issue on Linux with permissions issues</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">ARG USER_ID=1000</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">ARG GROUP_ID=1000</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">ARG APP_DIR=/home/user/myapp</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Create a non-root user</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN groupadd </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">gid $GROUP_ID user</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN useradd </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">no</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">log</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">init </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">uid $USER_ID </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">gid $GROUP_ID user </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">create</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">home</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Remove existing running server</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY entrypoint.sh /usr/bin/</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN chmod +x /usr/bin/entrypoint.sh</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Permissions crap</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN mkdir </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">p $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN chown </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">R $USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Define the user running the container</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">USER $USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">WORKDIR $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Install rails related dependencies</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">chown=$USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID Gemfile* $APP_DIR/</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># For webpacker / node_modules</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">chown=$USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID package.json $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">chown=$USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID yarn.lock $APP_DIR</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN bundle install</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Copy over all files</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">chown=$USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">$GROUP_ID . .</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">RUN yarn install </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">check</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">files</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">ENTRYPOINT </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;/usr/bin/entrypoint.sh&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Start the main process.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">CMD </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;rails&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;server&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;-b&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;0.0.0.0&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span></div></pre><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-yaml" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># docker-compose.yml</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;3&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">web</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">NODE_ENV</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> development</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">RAILS_ENV</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> development</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">WEBPACKER_DEV_SERVER_HOST</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> 0.0.0.0</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">POSTGRES_USER</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> postgres</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> example</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">context</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> .</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">args</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">        </span><span class="token key atrule">USER_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(255, 98, 140)">1000</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">        </span><span class="token key atrule">GROUP_ID</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(255, 98, 140)">1000</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">        </span><span class="token key atrule">APP_DIR</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> /home/user/myapp</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> bash </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">c &quot;rm </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">f tmp/pids/server.pid &amp;&amp;</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      ./bin/webpack</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">dev</span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">server &amp;</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      bundle exec rails server </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">p 3000 </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain">b &#x27;0.0.0.0&#x27;&quot;</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># make sure this lines up with APP_DIR above</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> .</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">/home/user/myapp</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;3000:3000&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;3035:3035&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> db</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">db</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> postgres</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token number" style="color:rgb(255, 98, 140)">12.2</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> example</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">-</span><span class="token plain"> db_data</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain">/var/lib/postgresql/data</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  db_data</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span></div></pre><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># entrypoint.sh</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">set</span><span class="token plain"> -e</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Remove a potentially pre-existing server.pid for Rails.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token function" style="color:rgb(250, 208, 0)">rm</span><span class="token plain"> -f /myapp/tmp/pids/server.pid</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Then exec the container&#x27;s main process (what&#x27;s set as CMD in the Dockerfile).</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token function" style="color:rgb(250, 208, 0)">exec</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span><span class="token string variable" style="color:rgb(255, 238, 128)">$@</span><span class="token string" style="color:rgb(165, 255, 144)">&quot;</span></div></pre><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-ruby" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain"># Gemfile</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">source &#x27;https://rubygems.org&#x27;</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">gem &#x27;rails&#x27;, &#x27;~&gt; 6&#x27;</span></div></pre><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-json" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token property" style="color:rgb(255, 157, 0)">&quot;_filename&quot;</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;package.json&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token property" style="color:rgb(255, 157, 0)">&quot;name&quot;</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;myapp&quot;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token property" style="color:rgb(255, 157, 0)">&quot;private&quot;</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 98, 140)">true</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token property" style="color:rgb(255, 157, 0)">&quot;version&quot;</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;1.0.0&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span></div></pre><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># .dockerignore</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># .dockerignore</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore bundler config.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/.bundle</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore all logfiles and tempfiles.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/log/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/tmp/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/log/.keep</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/tmp/.keep</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore pidfiles, but keep the directory.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/tmp/pids/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/tmp/pids/</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/tmp/pids/.keep</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore uploaded files in development.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/storage/*</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">/storage/.keep</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/public/assets</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">.byebug_history</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># Ignore master key for decrypting credentials and more.</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/config/master.key</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/public/packs</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/public/packs-test</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/node_modules</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">/yarn-error.log</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">yarn-debug.log*</span></div></pre><p>After setting up the above files, then run:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm --no-deps web rails new </span><span class="token keyword" style="color:rgb(255, 157, 0)">.</span><span class="token plain"> --force --no-deps --database</span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain">postgresql</span></div></pre><p>Now run:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose build</span></div></pre><p>After building the image, then install webpacker:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm web rails webpacker:install</span></div></pre><p>This will provide you with a base for webpacker.</p><p>Now setup the database in the <code>config/database.yml</code></p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-yaml" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic"># config/database.yml</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token important">&amp;default</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">adapter</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> postgresql</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">encoding</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> unicode</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> db</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> &lt;%= ENV</span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">&#x27;POSTGRES_USER&#x27;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"> %</span><span class="token punctuation" style="color:rgb(255, 255, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> &lt;%= ENV</span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">&#x27;POSTGRES_PASSWORD&#x27;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"> %</span><span class="token punctuation" style="color:rgb(255, 255, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">pool</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(255, 98, 140)">5</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">development</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">&lt;&lt;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token important">*default</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> myapp_development</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token key atrule">test</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">&lt;&lt;</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token important">*default</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> myapp_test</span></div></pre><p>Next create the database.</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose run --rm web </span><span class="token function" style="color:rgb(250, 208, 0)">bash</span><span class="token plain"> -c </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;rails db:create &amp;&amp; rails db:migrate&quot;</span></div></pre><p>Finally, start the app:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">docker-compose up</span></div></pre><p>Now you can view it on <code>localhost:3000</code></p><p>Now, to deploy the app, simply do the following:</p><div class="gatsby-code-meta" style="color:rgb(255, 255, 255);border-color:rgb(179, 98, 255)"><div class="gatsby-code-meta-text"></div><div class="gatsby-code-meta-text"><button name="copy code to clipboard" class="gatsby-code-meta-copy">Copy</button></div></div><pre class="prism-code language-bash" style="color:#9EFEFF;background-color:#2D2A55"><div class="token-line" style="color:#9EFEFF"><span class="token plain">heroku login</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">heroku apps:create </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token plain">App-name</span><span class="token operator" style="color:rgb(255, 157, 0)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token function" style="color:rgb(250, 208, 0)">git</span><span class="token plain"> push heroku master</span></div><div class="token-line" style="color:#9EFEFF"><span class="token plain">heroku run rails db:migrate</span></div></pre><p>And thats it ! Were all set and deployed.</p><h2 id="links"><a href="#links">Links</a></h2><p><a style="font-size:1.1rem" href="https://github.com/ParamagicDev/getting-started-with-rails-6/tree/master" id="source-code">Source Code on Github</a></p><p><a style="font-size:1.1rem" href="#todo" id="deployed-app">Deployed Application</a></p><h3 id="rails"><a href="#rails">Rails</a></h3><p><a href="https://rubyonrails.org/">Ruby on Rails Homepage</a></p><p><a href="https://guides.rubyonrails.org/getting_started.html">Ruby on Rails Getting Started Guide</a></p><p><a href="https://github.com/rails/webpacker">Webpacker Gem</a></p><h3 id="docker"><a href="#docker">Docker</a></h3><p><a href="https://docs.docker.com/compose/rails/">Docker Compose with Rails</a></p><h3 id="databases"><a href="#databases">PostgresQL</a></h3><p><a href="https://www.postgresql.org/">PostgresQL Homepage</a></p><h3 id="heroku"><a href="#heroku">Heroku</a></h3><p><a href="https://heroku.com">Heroku Homepage</a></p><p><a href="https://devcenter.heroku.com/articles/getting-started-with-rails6">Heroku with Rails
Deployment</a></p><h3 id="submit-a-pull-request"><a href="#submit-a-pull-request">Found something wrong? Submit a pull request!</a></h3><p><a href="https://github.com/ParamagicDev/my-blog/blob/master/content/blog/rails/getting-started-with-rails-6.md">Blog Source</a></p><p><a href="https://github.com/ParamagicDev/getting-started-with-rails-6">Rails App Source</a></p><hr style="margin-bottom:1.75rem"/><div style="display:flex;margin-bottom:4.375rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMEAv/EABYBAQEBAAAAAAAAAAAAAAAAAAIBAP/aAAwDAQACEAMQAAAByypYKbY1yag3gKf/xAAcEAABBAMBAAAAAAAAAAAAAAABAAIRIQMSEyL/2gAIAQEAAQUCyN9NFUju4twyeIUXMN3K/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPwE13//EABYRAAMAAAAAAAAAAAAAAAAAAAAQIf/aAAgBAgEBPwEj/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAEQMVFBkf/aAAgBAQAGPwJuKfpRunISj//EABwQAQEAAgIDAAAAAAAAAAAAAAERACExkRBhcf/aAAgBAQABPyFWiDZciq3eoYad+T7bIQMnTJcGNHy/cGBJPD//2gAMAwEAAgADAAAAELwYAf/EABcRAAMBAAAAAAAAAAAAAAAAAAEQIRH/2gAIAQMBAT8QFRkX/8QAFxEAAwEAAAAAAAAAAAAAAAAAARAhMf/aAAgBAgEBPxDBUFK//8QAIBABAAMAAgAHAAAAAAAAAAAAAQARITFBUWFxgZGhsf/aAAgBAQABPxBEBK03zIIEzvd+8TNRPYBb49zMtLU1R9xKLVboXr3GsIzWu5UahbnD4hLg3oK32jZyT//Z" alt="Konnor Rogers" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/621c3c9e2c72d5759211bcf58b1217ae/99438/profile-pic.jpg 1x,
/static/621c3c9e2c72d5759211bcf58b1217ae/aba1d/profile-pic.jpg 1.5x,
/static/621c3c9e2c72d5759211bcf58b1217ae/b315d/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/621c3c9e2c72d5759211bcf58b1217ae/99438/profile-pic.jpg 1x,
/static/621c3c9e2c72d5759211bcf58b1217ae/aba1d/profile-pic.jpg 1.5x,
/static/621c3c9e2c72d5759211bcf58b1217ae/b315d/profile-pic.jpg 2x" src="/static/621c3c9e2c72d5759211bcf58b1217ae/99438/profile-pic.jpg" alt="Konnor Rogers" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by <strong>Konnor Rogers</strong> who currently works as a paramedic looking to transition into becoming a full time software developer.<!-- --> <a href="https://twitter.com/rogerskonnor">You should follow him on Twitter</a></p></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/javascript/adding-emotion-typescript-and-jest/">← <!-- -->Adding Emotion, Typescript, and Jest to Gatsby</a></li><li><a rel="next" href="/bridgetownrb/dockerizing-bridgetown/">Dockerizing Bridgetown<!-- --> →</a></li></ul><footer>© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/rails/getting-started-with-rails-6/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-dfd7e3cc412d2a4138ba.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-d9ff9b04d73194b6d64a.js"],"component---src-pages-404-js":["/component---src-pages-404-js-4e7446d54464441693a9.js"],"component---src-pages-index-js":["/component---src-pages-index-js-5060e0d50303783126c1.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-a1eb9d2be463054631c2.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-a1eb9d2be463054631c2.js" async=""></script><script src="/cd7d5f864fc9e15ed8adef086269b0aeff617554-caa56a3535a2d7b69d6c.js" async=""></script><script src="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-ef5a3f720f86f4181618.js" async=""></script><script src="/app-dfd7e3cc412d2a4138ba.js" async=""></script><script src="/f0e45107-357d362de354e57f12c0.js" async=""></script><script src="/styles-0088909554f7ad2ac065.js" async=""></script><script src="/framework-75da9754c2a76bbaf08a.js" async=""></script><script src="/webpack-runtime-d400cf8828ee40283933.js" async=""></script></body></html>