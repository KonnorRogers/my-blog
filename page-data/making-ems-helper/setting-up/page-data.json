{"componentChunkName":"component---src-templates-blog-post-js","path":"/making-ems-helper/setting-up/","result":{"data":{"site":{"siteMetadata":{"title":"Konnor's Blog","author":"Konnor Rogers"}},"markdownRemark":{"id":"8ebf655f-aa79-56fa-b7b3-ce8fae5367e2","excerpt":"Github Repo Creating a Rails 6 app  This will generate the initial project structure. I will be using postgresql as my database. Adding .env files I added the…","html":"<h2><a href=\"https://github.com/ParamagicDev/ems_helper/tree/cd623419d8c885cac66c1d3e6fa0f8507d35b686\">Github Repo</a></h2>\n<h2>Creating a Rails 6 app</h2>\n<p><code class=\"language-text\">rails new ems_helper --database=postgresql</code></p>\n<p>This will generate the initial project structure. I will be using postgresql as my database.</p>\n<h3>Adding .env files</h3>\n<p>I added the .env file as well the <code class=\"language-text\">dotenv-rails</code> gem to allow the use\nof the .env files to allow for easy local development for things that requires\nlogins or API keys.</p>\n<p><a href=\"https://github.com/ParamagicDev/ems_helper/blob/master/Gemfile\">My gemfile</a></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># Gemfile</span>\n\n<span class=\"token comment\"># ...</span>\n<span class=\"token comment\"># Make sure it is the first gem added. This way gems that require privileges</span>\n<span class=\"token comment\"># can inherit from dotenv-rails</span>\ngem <span class=\"token string\">'dotenv-rails'</span><span class=\"token punctuation\">,</span> groups<span class=\"token punctuation\">:</span> <span class=\"token string\">%i[development test]</span>\n<span class=\"token comment\"># ...</span></code></pre></div>\n<h2>Docker</h2>\n<p>First things first, setup a Dockerfile in the root directory.</p>\n<h3>Adding Dockerfile</h3>\n<p><a href=\"https://github.com/ParamagicDev/ems_helper/blob/master/Dockerfile\">My Dockerfile</a></p>\n<p>Basically, pull in Ruby 2.6.3, add nodejs, and add all packages is what this Dockerfile does.</p>\n<h3>Setting up docker-compose</h3>\n<p>docker-compose is a utility provided by Docker to pull in various components.</p>\n<p>IE: Redis, Memcache, caching layer, PostgresQL, MySQL, MonogoDB databases, and various\nother web components.</p>\n<p>Here is a link to my <a href=\"https://github.com/ParamagicDev/ems_helper/blob/master/docker-compose.yml\">docker-compose.yml</a> file which pulls in PostgresQL.</p>\n<p>I pulled most of this config off the <a href=\"https://docs.docker.com/compose/rails/\">Docker official documentation</a>.</p>\n<h3>Docker-compose commands</h3>\n<p>Before we get into building the project, let’s take a look at some basic commands:</p>\n<p><code class=\"language-text\">docker-compose down</code> to bring down the container\n<code class=\"language-text\">docker-compose up --build</code> rebuilds the container if you make changes.\n<code class=\"language-text\">docker-compose run web &lt;command&gt;</code> will run the commands from inside the container.</p>\n<p>If for some reason the items listed below do not work, try resetting the container.</p>\n<p>Also, if you add something to the <code class=\"language-text\">Gemfile</code>, to update the container you must do the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker-compose run web bundle <span class=\"token function\">install</span>\ndocker-compose down\n\n<span class=\"token comment\"># You must rebuild the container because the Gemfile.lock has been updated as well</span>\ndocker-compose up --build</code></pre></div>\n<h3>Setting up Rails with docker-compose</h3>\n<p>Alright time to start everything up.</p>\n<p>Run a <code class=\"language-text\">docker-compose up --build</code>.\nThen run the following inside a seperate terminal once that has all finished</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker-compose run --rm web rails db:setup</code></pre></div>\n<p><br><br></p>\n<p>You will most likely run into an issue with postgres.\nTo fix this, navigate to <code class=\"language-text\">./config/database.yml</code></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token important\">&amp;default</span>\n  <span class=\"token key atrule\">adapter</span><span class=\"token punctuation\">:</span> postgresql\n  <span class=\"token key atrule\">encoding</span><span class=\"token punctuation\">:</span> unicode\n  <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> &lt;%= ENV<span class=\"token punctuation\">[</span><span class=\"token string\">'PG_HOST'</span><span class=\"token punctuation\">]</span> %<span class=\"token punctuation\">></span>\n  <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> &lt;%= ENV<span class=\"token punctuation\">[</span><span class=\"token string\">'PG_USER'</span><span class=\"token punctuation\">]</span> %<span class=\"token punctuation\">></span>\n  <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> &lt;%= ENV<span class=\"token punctuation\">[</span><span class=\"token string\">'PG_PASSWORD'</span><span class=\"token punctuation\">]</span> %<span class=\"token punctuation\">></span>\n  <span class=\"token key atrule\">pool</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\n\n<span class=\"token key atrule\">development</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*default</span>\n  <span class=\"token key atrule\">database</span><span class=\"token punctuation\">:</span> myapp_development\n\n<span class=\"token key atrule\">test</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*default</span>\n  <span class=\"token key atrule\">database</span><span class=\"token punctuation\">:</span> myapp_test</code></pre></div>\n<p><br><br></p>\n<p>Now here’s where it gets a little tricky.<br>\nIn the root directory, create a file called <code class=\"language-text\">.env</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># .env</span>\n\n<span class=\"token assign-left variable\">PG_USER</span><span class=\"token operator\">=</span><span class=\"token string\">'postgres'</span>\n\n<span class=\"token comment\"># Docker does not use a password on the container for local development</span>\n<span class=\"token assign-left variable\">PG_PASSWORD</span><span class=\"token operator\">=</span><span class=\"token string\">''</span>\n\n<span class=\"token comment\"># Change this to '' if not using docker. I have also set this manually inside of</span>\n<span class=\"token comment\"># the docker-compose.yml file.</span>\n<span class=\"token assign-left variable\">PG_HOST</span><span class=\"token operator\">=</span><span class=\"token string\">'db'</span></code></pre></div>\n<p><br><br></p>\n<p>Docker documentation says to use ‘db’ as the host in the <code class=\"language-text\">database.yml</code> file.<br>\nYou will run into an error if you do not do this. I spent over 2 hours debugging this.\nNot a fun time.</p>\n<p>Now, you should be able to create the database!</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># equivalent to rails db:create &amp;&amp; rails db:migrate &amp;&amp; rails db:seed</span>\ndocker-compose run --rm web rails db:setup</code></pre></div>\n<p><br><br></p>\n<p>Finally, in your browser navigate to <code class=\"language-text\">localhost:3000</code></p>\n<p>The “Hello, Welcome to Rails” page should appear!</p>\n<h4>Permissions Errors</h4>\n<p>If on Linux, for me there are some permissions issues with Docker. <br>\nEnsure to <code class=\"language-text\">chown -R .</code> from the root directory after using Docker if you run into\npermissions issues</p>\n<h3>Adding TailwindCSS</h3>\n<p>I really enjoy using <a href=\"https://tailwindcss.com\">TailwindCSS</a> so I added it into\nthe application.</p>\n<p>There’s a few steps to this.</p>\n<ol>\n<li><code class=\"language-text\">yarn add tailwindcss</code> - add the tailwindcss node module</li>\n<li>Then, create a tailwind stylesheet called <code class=\"language-text\">./app/javascript/stylesheets/tailwind.scss</code>\nAdd the base classes.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token comment\">// app/javascript/stylesheets/tailwind.css</span>\n<span class=\"token keyword\">@import</span> <span class=\"token string\">\"tailwindcss/base\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">@import</span> <span class=\"token string\">\"tailwindcss/components\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">@import</span> <span class=\"token string\">\"tailwindcss/utilities\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><br><br></p>\n<ol start=\"3\">\n<li>Inside <code class=\"language-text\">./app/javascript/packs/application.js</code> add the following require statement.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// app/javascript/packs/application.js</span>\n\n<span class=\"token comment\">// ...</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stylesheets/tailwind.scss\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p><br><br></p>\n<ol start=\"4\">\n<li>Finally, inside of <code class=\"language-text\">./app/views/layouts/application.html.erb</code></li>\n</ol>\n<p>Add a stylesheet pack tag inside the head of the view</p>\n<div class=\"gatsby-highlight\" data-language=\"erb\"><pre class=\"language-erb\"><code class=\"language-erb\"><span class=\"token erb language-erb\"><span class=\"token delimiter punctuation\">&lt;%</span><span class=\"token comment\"># app/views/layouts/application.html.erb </span><span class=\"token delimiter punctuation\">%></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n# ...\n<span class=\"token erb language-erb\"><span class=\"token delimiter punctuation\">&lt;%=</span> stylesheet_pack_tag <span class=\"token string\">'application'</span><span class=\"token punctuation\">,</span> media<span class=\"token punctuation\">:</span> <span class=\"token string\">'all'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'data-turbolinks-track'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'reload'</span> <span class=\"token delimiter punctuation\">%></span></span>\n# ...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><br><br></p>\n<ol start=\"5\">\n<li>Unfortunately, you can’t really test that everything is working yet. So, let’s make it work!</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker-compose run --rm web rails generate controller static_pages index</code></pre></div>\n<p><br><br></p>\n<p>Navigate to <code class=\"language-text\">config/routes.rb</code> and add the following</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">Rails</span><span class=\"token punctuation\">.</span>application<span class=\"token punctuation\">.</span>routes<span class=\"token punctuation\">.</span>draw <span class=\"token keyword\">do</span>\n  <span class=\"token comment\"># For details on the DSL available within this file, see https://guides.rubyonrails.org/routing.html</span>\n  root <span class=\"token string\">'static_pages#index'</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p><br><br></p>\n<ol start=\"6\">\n<li>Bringing it all together, to ensure everything works as correctly, add a Tailwind\nclass to an html element.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"erb\"><pre class=\"language-erb\"><code class=\"language-erb\"><span class=\"token erb language-erb\"><span class=\"token delimiter punctuation\">&lt;%</span><span class=\"token comment\"># app/views/static_pages/index.html.erb </span><span class=\"token delimiter punctuation\">%></span></span>\n\n<span class=\"token erb language-erb\"><span class=\"token delimiter punctuation\">&lt;%</span><span class=\"token comment\"># ... </span><span class=\"token delimiter punctuation\">%></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text-red-500<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    Hello there!\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token erb language-erb\"><span class=\"token delimiter punctuation\">&lt;%</span><span class=\"token comment\"># ... </span><span class=\"token delimiter punctuation\">%></span></span></code></pre></div>\n<p><br><br></p>\n<p>And thats it! You’re now fully setup with Rails 6, webpack, TailwindCSS, Docker / docker-compose\nFrom here, its time to start parsing the API content. That will be the next installment\nI will write!</p>\n<h2>Links</h2>\n<p>Special thanks to Chris @ gorails for his free content.\nHe helped me with the tailwind setup.\n<a href=\"https://gorails.com/episodes/tailwindcss-1-0-with-rails-6\">Tailwind Setup Video</a></p>\n<p>Docker documentation is fantastic check it out.\n<a href=\"https://docs.docker.com/\">Docker Docs</a></p>\n<p>Check out the Rails docs obviously\n<a href=\"https://rubyonrails.org/\">Rails Docs</a></p>\n<p>Finally, feel free to follow along with my repo. Most of the development will take\nplace on the <code class=\"language-text\">development branch</code>.</p>\n<p><a href=\"https://github.com/ParamagicDev/ems_helper\">Github Repo</a></p>\n<h4>EDIT</h4>\n<p>I create a Rails 6 skeleton for tailwind css <a href=\"https://github.com/ParamagicDev/rails6-skeleton/tree/tailwindcss\">HERE</a></p>","frontmatter":{"title":"Making EMS Helper - Setting up","date":"December 08, 2019","description":"Detailing the initial setup of EMS Helper with Rails 6, Webpack, TailwindCSS, Docker, and Docker-Compose"}}},"pageContext":{"slug":"/making-ems-helper/setting-up/","previous":{"fields":{"slug":"/making-ems-helper/introduction/"},"frontmatter":{"title":"Making EMS Helper - Introduction"}},"next":{"fields":{"slug":"/making-ems-helper/hiccups/"},"frontmatter":{"title":"Making EMS Helper - Hiccups"}}}}}